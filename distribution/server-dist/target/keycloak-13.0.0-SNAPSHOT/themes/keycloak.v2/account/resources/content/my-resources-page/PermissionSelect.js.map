{"version":3,"sources":["../../../src/app/content/my-resources-page/PermissionSelect.tsx"],"names":["React","Select","SelectOption","SelectVariant","ScopeValue","constructor","value","toString","displayName","name","compareTo","selectOption","PermissionSelect","Component","props","_event","selection","selected","state","onSelect","includes","setState","prevState","filter","item","map","sv","isExpanded","values","s","scopes","option","index","find","render","titleId","direction","typeaheadMulti","onToggle","clearSelection"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\n\r\nimport { Select, SelectOption, SelectVariant, SelectOptionObject } from '@patternfly/react-core';\r\nimport { Scope } from './resource-model';\r\n\r\ninterface PermissionSelectState {\r\n  selected: ScopeValue[];\r\n  isExpanded: boolean;\r\n  scopes: JSX.Element[];\r\n}\r\n\r\ninterface PermissionSelectProps {\r\n  scopes: Scope[];\r\n  selected?: Scope[];\r\n  direction?: 'up' | 'down';\r\n  onSelect: (selected: Scope[]) => void;\r\n}\r\n\r\nclass ScopeValue implements SelectOptionObject {\r\n  value: Scope;\r\n  constructor(value: Scope) {\r\n    this.value = value;\r\n  }\r\n\r\n  toString() {\r\n    return this.value.displayName ? this.value.displayName : this.value.name;\r\n  }\r\n\r\n  compareTo(selectOption: Scope): boolean {\r\n    return selectOption.name === this.value.name;\r\n  }\r\n}\r\n\r\nexport class PermissionSelect extends React.Component<PermissionSelectProps, PermissionSelectState> {\r\n  constructor(props: PermissionSelectProps) {\r\n    super(props);\r\n\r\n    let values: ScopeValue[] = [];\r\n    if (this.props.selected) {\r\n      values = this.props.selected!.map(s => new ScopeValue(s))\r\n    }\r\n\r\n    this.state = {\r\n      isExpanded: false,\r\n      selected: values,\r\n      scopes: this.props.scopes.map((option, index) => (\r\n        <SelectOption key={index} value={values.find(s => s.compareTo(option)) || new ScopeValue(option)} />\r\n      ))\r\n    };\r\n  }\r\n\r\n  private onSelect = (_event: React.MouseEvent | React.ChangeEvent, selection: ScopeValue): void => {\r\n    const { selected } = this.state;\r\n    const { onSelect } = this.props;\r\n    if (selected.includes(selection)) {\r\n      this.setState(\r\n        prevState => ({ selected: prevState.selected.filter(item => item !== selection) }),\r\n        () => onSelect(this.state.selected.map(sv => sv.value))\r\n      );\r\n    } else {\r\n      this.setState(\r\n        prevState => ({ selected: [...prevState.selected, selection] }),\r\n        () => onSelect(this.state.selected.map(sv => sv.value))\r\n      );\r\n    }\r\n  }\r\n\r\n  private onToggle = (isExpanded: boolean) => {\r\n    this.setState({\r\n      isExpanded\r\n    });\r\n  }\r\n\r\n  private clearSelection = () => {\r\n    this.setState({\r\n      selected: [],\r\n      isExpanded: false\r\n    });\r\n    this.props.onSelect([]);\r\n  };\r\n\r\n  render() {\r\n    const { isExpanded, selected } = this.state;\r\n    const titleId = 'permission-id';\r\n\r\n    return (\r\n      <div>\r\n        <span id={titleId} hidden>\r\n          Select the permissions\r\n        </span>\r\n        <Select\r\n          direction={this.props.direction || 'down'}\r\n          variant={SelectVariant.typeaheadMulti}\r\n          ariaLabelTypeAhead=\"Select the permissions\"\r\n          onToggle={this.onToggle}\r\n          onSelect={this.onSelect}\r\n          onClear={this.clearSelection}\r\n          selections={selected}\r\n          isExpanded={isExpanded}\r\n          ariaLabelledBy={titleId}\r\n          placeholderText=\"Select the permissions\"\r\n        >\r\n          {this.state.scopes}\r\n        </Select>\r\n      </div>\r\n    );\r\n  }\r\n}"],"file":"PermissionSelect.js"}