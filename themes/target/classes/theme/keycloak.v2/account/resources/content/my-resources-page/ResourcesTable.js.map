{"version":3,"sources":["../../../src/app/content/my-resources-page/ResourcesTable.tsx"],"names":["React","DataList","DataListItem","DataListItemRow","DataListCell","DataListToggle","DataListContent","DataListItemCells","Level","LevelItem","Button","DataListAction","DataListActionVisibility","Dropdown","DropdownPosition","DropdownItem","KebabToggle","css","Remove2Icon","RepositoryIcon","ShareAltIcon","EditAltIcon","AccountServiceContext","PermissionRequest","ShareTheResource","Msg","AbstractResourcesTable","EditTheResource","ContentAlert","EmptyMessageState","ContinueCancelModal","ResourcesTable","constructor","props","context","row","newIsRowOpen","state","isRowOpen","fetchPermissions","resources","data","setState","isOpen","isModalActive","contextOpen","index","length","permissions","Map","resource","doGet","_id","then","response","newPermissions","set","removeShare","get","map","a","username","scopes","doPut","success","localize","render","visibility","name","onToggle","client","baseUrl","getClientName","shareRequests","hiddenOnLg","right","onContextToggle","sharedWithUsersMessage","toggle","numOthers","visibleOnLg","hidden"],"mappings":";;AAAA;;;;;;;;;;;;;;;AAgBA,OAAO,KAAKA,KAAZ;AAEA,SACIC,QADJ,EAEIC,YAFJ,EAGIC,eAHJ,EAIIC,YAJJ,EAKIC,cALJ,EAMIC,eANJ,EAOIC,iBAPJ,EAQIC,KARJ,EASIC,SATJ,EAUIC,MAVJ,EAWIC,cAXJ,EAYIC,wBAZJ,EAaIC,QAbJ,EAcIC,gBAdJ,EAeIC,YAfJ,EAgBIC,WAhBJ;AAkBA,SAASC,GAAT;AAEA,SAASC,WAAT,EAAsBC,cAAtB,EAAsCC,YAAtC,EAAoDC,WAApD;AAGA,SAASC,qBAAT;AACA,SAASC,iBAAT;AACA,SAASC,gBAAT;AAEA,SAASC,GAAT;AACA,SAAmDC,sBAAnD;AACA,SAASC,eAAT;AACA,SAASC,YAAT;AACA,OAAOC,iBAAP;AACA,SAASC,mBAAT;AAQA,OAAO,MAAMC,cAAN,SAA6BL,sBAA7B,CAAoF;AAIhFM,EAAAA,WAAP,CAAmBC,KAAnB,EAA+CC,OAA/C,EAAyG;AACrG,UAAMD,KAAN;;AADqG;;AAAA,sCAYrFE,GAAD,IAAuB;AACtC,YAAMC,YAAuB,GAAG,KAAKC,KAAL,CAAWC,SAA3C;AACAF,MAAAA,YAAY,CAACD,GAAD,CAAZ,GAAoB,CAACC,YAAY,CAACD,GAAD,CAAjC;AACA,UAAIC,YAAY,CAACD,GAAD,CAAhB,EAAuB,KAAKI,gBAAL,CAAsB,KAAKN,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BN,GAA1B,CAAtB,EAAsDA,GAAtD;AACvB,WAAKO,QAAL,CAAc;AAAEJ,QAAAA,SAAS,EAAEF;AAAb,OAAd;AACH,KAjBwG;;AAAA,6CAmB/E,CAACD,GAAD,EAAcQ,MAAd,KAAwC;AAC9D,UAAI,KAAKN,KAAL,CAAWO,aAAf,EAA8B;AAC9B,YAAMH,IAAI,GAAG,KAAKR,KAAL,CAAWO,SAAX,CAAqBC,IAAlC;AACA,YAAMI,WAAW,GAAG,KAAKR,KAAL,CAAWQ,WAA/B;AACAA,MAAAA,WAAW,CAACV,GAAD,CAAX,GAAmBQ,MAAnB;;AACA,UAAIA,MAAJ,EAAY;AACR,cAAMG,KAAK,GAAGX,GAAG,GAAGM,IAAI,CAACM,MAAX,GAAoBZ,GAAG,GAAGM,IAAI,CAACM,MAAX,GAAoB,CAAxC,GAA4CZ,GAA1D;AACA,aAAKI,gBAAL,CAAsBE,IAAI,CAACK,KAAD,CAA1B,EAAmCA,KAAnC;AACH;;AACD,WAAKJ,QAAL,CAAc;AAAEG,QAAAA;AAAF,OAAd;AACH,KA7BwG;;AAErG,SAAKX,OAAL,GAAeA,OAAf;AAEA,SAAKG,KAAL,GAAa;AACTC,MAAAA,SAAS,EAAE,EADF;AAETO,MAAAA,WAAW,EAAE,EAFJ;AAGTD,MAAAA,aAAa,EAAE,KAHN;AAITI,MAAAA,WAAW,EAAE,IAAIC,GAAJ;AAJJ,KAAb;AAMH;;AAqBOV,EAAAA,gBAAR,CAAyBW,QAAzB,EAA6Cf,GAA7C,EAAgE;AAC5D,SAAKD,OAAL,CAAciB,KAAd,CAAqB,cAAaD,QAAQ,CAACE,GAAI,cAA/C,EACKC,IADL,CACWC,QAAD,IAA0C;AAC5C,YAAMC,cAAyC,GAAG,IAAIN,GAAJ,CAAQ,KAAKZ,KAAL,CAAWW,WAAnB,CAAlD;AACAO,MAAAA,cAAc,CAACC,GAAf,CAAmBrB,GAAnB,EAAwBmB,QAAQ,CAACb,IAAT,IAAiB,EAAzC;AACA,WAAKC,QAAL,CAAc;AAAEM,QAAAA,WAAW,EAAEO;AAAf,OAAd;AACH,KALL;AAMH;;AAEOE,EAAAA,WAAR,CAAoBP,QAApB,EAAwCf,GAAxC,EAAoE;AAChE,UAAMa,WAAW,GAAG,KAAKX,KAAL,CAAWW,WAAX,CAAuBU,GAAvB,CAA2BvB,GAA3B,EAAiCwB,GAAjC,CAAqCC,CAAC,KAAK;AAAEC,MAAAA,QAAQ,EAAED,CAAC,CAACC,QAAd;AAAwBC,MAAAA,MAAM,EAAE;AAAhC,KAAL,CAAtC,CAApB;AACA,WAAO,KAAK5B,OAAL,CAAc6B,KAAd,CAAqB,cAAab,QAAQ,CAACE,GAAI,cAA/C,EAA8DJ,WAA9D,EACFK,IADE,CACG,MAAM;AACRzB,MAAAA,YAAY,CAACoC,OAAb,CAAqBvC,GAAG,CAACwC,QAAJ,CAAa,gBAAb,CAArB;AACH,KAHE,CAAP;AAIH;;AAEMC,EAAAA,MAAP,GAAiC;AAC7B,QAAI,KAAKjC,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAA1B,KAAqC,CAAzC,EAA4C;AACxC,aACI,oBAAC,iBAAD;AAAmB,QAAA,IAAI,EAAE5B,cAAzB;AAAyC,QAAA,UAAU,EAAC;AAApD,QADJ;AAGH;;AACD,WACI,oBAAC,QAAD;AAAU,oBAAYM,GAAG,CAACwC,QAAJ,CAAa,WAAb,CAAtB;AAAiD,MAAA,EAAE,EAAC;AAApD,OACI,oBAAC,YAAD;AAAc,MAAA,GAAG,EAAC,iBAAlB;AAAoC,yBAAgB;AAApD,OACI,oBAAC,eAAD,mEAEI;AAAM,MAAA,KAAK,EAAE;AAAEE,QAAAA,UAAU,EAAE;AAAd;AAAb,OACI,oBAAC,cAAD;AACI,MAAA,UAAU,EAAE,KADhB;AAEI,MAAA,EAAE,EAAC,kCAFP;AAGI,uBAAc;AAHlB,MADJ,CAFJ,EASI,oBAAC,iBAAD;AACI,MAAA,aAAa,EAAE,CACX,oBAAC,YAAD;AAAc,QAAA,GAAG,EAAC,sBAAlB;AAAyC,QAAA,KAAK,EAAE;AAAhD,SACI,oCAAQ,oBAAC,GAAD;AAAK,QAAA,MAAM,EAAC;AAAZ,QAAR,CADJ,CADW,EAIX,oBAAC,YAAD;AAAc,QAAA,GAAG,EAAC,yBAAlB;AAA4C,QAAA,KAAK,EAAE;AAAnD,SACI,oCAAQ,oBAAC,GAAD;AAAK,QAAA,MAAM,EAAC;AAAZ,QAAR,CADJ,CAJW,EAOX,oBAAC,YAAD;AAAc,QAAA,GAAG,EAAC,2BAAlB;AAA8C,QAAA,KAAK,EAAE;AAArD,SACI,oCAAQ,oBAAC,GAAD;AAAK,QAAA,MAAM,EAAC;AAAZ,QAAR,CADJ,CAPW;AADnB,MATJ,CADJ,CADJ,EA0BK,KAAKlC,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BkB,GAA1B,CAA8B,CAACT,QAAD,EAAqBf,GAArB,KAC3B,oBAAC,YAAD;AAAc,MAAA,GAAG,EAAE,cAAcA,GAAjC;AAAsC,yBAAiBe,QAAQ,CAACkB,IAAhE;AAAsE,MAAA,UAAU,EAAE,KAAK/B,KAAL,CAAWC,SAAX,CAAqBH,GAArB;AAAlF,OACI,oBAAC,eAAD,QACI,oBAAC,cAAD;AACI,MAAA,OAAO,EAAE,MAAM,KAAKkC,QAAL,CAAclC,GAAd,CADnB;AAEI,MAAA,UAAU,EAAE,KAAKE,KAAL,CAAWC,SAAX,CAAqBH,GAArB,CAFhB;AAGI,MAAA,EAAE,EAAE,oBAAoBA,GAH5B;AAII,uBAAc;AAJlB,MADJ,EAOI,oBAAC,iBAAD;AACI,MAAA,aAAa,EAAE,CACX,oBAAC,YAAD;AAAc,QAAA,EAAE,EAAE,kBAAkBA,GAApC;AAAyC,QAAA,GAAG,EAAE,kBAAkBA,GAAhE;AAAqE,QAAA,KAAK,EAAE;AAA5E,SACI,oBAAC,GAAD;AAAK,QAAA,MAAM,EAAEe,QAAQ,CAACkB;AAAtB,QADJ,CADW,EAIX,oBAAC,YAAD;AAAc,QAAA,EAAE,EAAE,oBAAoBjC,GAAtC;AAA2C,QAAA,GAAG,EAAE,oBAAoBA,GAApE;AAAyE,QAAA,KAAK,EAAE;AAAhF,SACI;AAAG,QAAA,IAAI,EAAEe,QAAQ,CAACoB,MAAT,CAAgBC;AAAzB,SAAmC,KAAKC,aAAL,CAAmBtB,QAAQ,CAACoB,MAA5B,CAAnC,CADJ,CAJW,EAOX,oBAAC,YAAD;AAAc,QAAA,EAAE,EAAE,sBAAsBnC,GAAxC;AAA6C,QAAA,GAAG,EAAE,wBAAwBA,GAA1E;AAA+E,QAAA,KAAK,EAAE;AAAtF,SACKe,QAAQ,CAACuB,aAAT,CAAuB1B,MAAvB,GAAgC,CAAhC,IACG,oBAAC,iBAAD;AACI,QAAA,QAAQ,EAAEG,QADd;AAEI,QAAA,OAAO,EAAE,MAAM,KAAKX,gBAAL,CAAsBW,QAAtB,EAAgCf,GAAhC;AAFnB,QAFR,CAPW;AADnB,MAPJ,EAyBI,oBAAC,cAAD;AACI,MAAA,SAAS,EAAEvB,wBAAwB,CAAC8D,UADxC;AAEI,yBAAgB,yCAFpB;AAGI,MAAA,EAAE,EAAC,sBAHP;AAII,oBAAW;AAJf,OAMI,oBAAC,QAAD;AACI,MAAA,OAAO,MADX;AAEI,MAAA,QAAQ,EAAE5D,gBAAgB,CAAC6D,KAF/B;AAGI,MAAA,QAAQ,EAAE,MAAM,KAAKjC,QAAL,CAAc;AAAEE,QAAAA,aAAa,EAAE;AAAjB,OAAd,CAHpB;AAII,MAAA,MAAM,EAAE,oBAAC,WAAD;AAAa,QAAA,QAAQ,EAAED,MAAM,IAAI,KAAKiC,eAAL,CAAqBzC,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAA9D,EAAiEJ,MAAjE;AAAjC,QAJZ;AAKI,MAAA,MAAM,EAAE,KAAKN,KAAL,CAAWQ,WAAX,CAAuBV,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAAhE,CALZ;AAMI,MAAA,aAAa,EAAE,CACX,oBAAC,gBAAD;AACI,QAAA,QAAQ,EAAEG,QADd;AAEI,QAAA,WAAW,EAAE,KAAKb,KAAL,CAAWW,WAAX,CAAuBU,GAAvB,CAA2BvB,GAA3B,CAFjB;AAGI,QAAA,kBAAkB,EAAE,KAAK0C,sBAAL,CAA4B1C,GAA5B,CAHxB;AAII,QAAA,OAAO,EAAE,MAAM;AACX,eAAKO,QAAL,CAAc;AAAEE,YAAAA,aAAa,EAAE;AAAjB,WAAd,EAAwC,MAAM;AAC1C,iBAAKgC,eAAL,CAAqBzC,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAA9D,EAAiE,KAAjE;AACA,iBAAKR,gBAAL,CAAsBW,QAAtB,EAAgCf,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAAzE;AACH,WAHD;AAIH;AATL,SAYS+B,MAAD,IACI,oBAAC,YAAD;AAAc,QAAA,EAAE,EAAE,eAAe3C,GAAjC;AAAsC,QAAA,GAAG,EAAC,WAA1C;AAAsD,QAAA,OAAO,EAAE2C;AAA/D,SACI,oBAAC,YAAD,OADJ,OACqB,oBAAC,GAAD;AAAK,QAAA,MAAM,EAAC;AAAZ,QADrB,CAbZ,CADW,EAmBX,oBAAC,eAAD;AACI,QAAA,QAAQ,EAAE5B,QADd;AAEI,QAAA,WAAW,EAAE,KAAKb,KAAL,CAAWW,WAAX,CAAuBU,GAAvB,CAA2BvB,GAA3B,CAFjB;AAGI,QAAA,OAAO,EAAE,MAAM;AACX,eAAKO,QAAL,CAAc;AAAEE,YAAAA,aAAa,EAAE;AAAjB,WAAd,EAAwC,MAAM;AAC1C,iBAAKgC,eAAL,CAAqBzC,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAA9D,EAAiE,KAAjE;AACA,iBAAKR,gBAAL,CAAsBW,QAAtB,EAAgCf,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAAzE;AACH,WAHD;AAIH;AARL,SAWS+B,MAAD,IACI,oBAAC,YAAD;AACI,QAAA,EAAE,EAAE,cAAc3C,GADtB;AAC2B,QAAA,GAAG,EAAC,UAD/B;AAEI,QAAA,UAAU,EAAE,KAAK4C,SAAL,CAAe5C,GAAf,IAAsB,CAFtC;AAGI,QAAA,OAAO,EAAE2C;AAHb,SAKI,oBAAC,WAAD,OALJ,OAKoB,oBAAC,GAAD;AAAK,QAAA,MAAM,EAAC;AAAZ,QALpB,CAZZ,CAnBW,EAwCX,oBAAC,mBAAD;AACI,QAAA,MAAM,EAAGA,MAAD,IACJ,oBAAC,YAAD;AACI,UAAA,EAAE,EAAE,gBAAgB3C,GADxB;AAEI,UAAA,GAAG,EAAC,YAFR;AAGI,UAAA,UAAU,EAAE,KAAK4C,SAAL,CAAe5C,GAAf,IAAsB,CAHtC;AAII,UAAA,OAAO,EAAE2C;AAJb,WAMI,oBAAC,WAAD,OANJ,OAMoB,oBAAC,GAAD;AAAK,UAAA,MAAM,EAAC;AAAZ,UANpB,CAFR;AAWI,QAAA,UAAU,EAAC,SAXf;AAYI,QAAA,YAAY,EAAC,mBAZjB;AAaI,QAAA,OAAO,EAAE,MACL,KAAKpC,QAAL,CAAc;AAAEE,UAAAA,aAAa,EAAE;AAAjB,SAAd,EAAwC,MAAM;AAC1C,eAAKgC,eAAL,CAAqBzC,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAA9D,EAAiE,KAAjE;AACH,SAFD,CAdR;AAkBI,QAAA,UAAU,EAAE,MAAM,KAAKU,WAAL,CAAiBP,QAAjB,EAA2Bf,GAA3B,EACbkB,IADa,CACR,MAAM,KAAKd,gBAAL,CAAsBW,QAAtB,EAAgCf,GAAG,GAAG,KAAKF,KAAL,CAAWO,SAAX,CAAqBC,IAArB,CAA0BM,MAAhC,GAAyC,CAAzE,CADE;AAlBtB,QAxCW;AANnB,MANJ,CAzBJ,EAqGI,oBAAC,cAAD;AACI,MAAA,EAAE,EAAG,WAAUZ,GAAI,EADvB;AAEI,MAAA,SAAS,EAAElB,GAAG,CAACL,wBAAwB,CAACoE,WAA1B,EAAuCpE,wBAAwB,CAACqE,MAAhE,CAFlB;AAGI,yBAAgB,aAHpB;AAII,oBAAW;AAJf,OAMI,oBAAC,gBAAD;AACI,MAAA,QAAQ,EAAE/B,QADd;AAEI,MAAA,WAAW,EAAE,KAAKb,KAAL,CAAWW,WAAX,CAAuBU,GAAvB,CAA2BvB,GAA3B,CAFjB;AAGI,MAAA,kBAAkB,EAAE,KAAK0C,sBAAL,CAA4B1C,GAA5B,CAHxB;AAII,MAAA,OAAO,EAAE,MAAM,KAAKI,gBAAL,CAAsBW,QAAtB,EAAgCf,GAAhC;AAJnB,OAOS2C,MAAD,IACI,oBAAC,MAAD;AAAQ,MAAA,EAAE,EAAG,SAAQ3C,GAAI,EAAzB;AAA4B,MAAA,OAAO,EAAC,MAApC;AAA2C,MAAA,OAAO,EAAE2C;AAApD,OACI,oBAAC,YAAD,OADJ,OACqB,oBAAC,GAAD;AAAK,MAAA,MAAM,EAAC;AAAZ,MADrB,CARZ,CANJ,EAoBI,oBAAC,QAAD;AACI,MAAA,EAAE,EAAG,eAAc3C,GAAI,EAD3B;AAEI,MAAA,OAAO,MAFX;AAGI,MAAA,QAAQ,EAAErB,gBAAgB,CAAC6D,KAH/B;AAII,MAAA,MAAM,EAAE,oBAAC,WAAD;AAAa,QAAA,QAAQ,EAAEhC,MAAM,IAAI,KAAKiC,eAAL,CAAqBzC,GAArB,EAA0BQ,MAA1B;AAAjC,QAJZ;AAKI,MAAA,QAAQ,EAAE,MAAM,KAAKD,QAAL,CAAc;AAAEE,QAAAA,aAAa,EAAE;AAAjB,OAAd,CALpB;AAMI,MAAA,MAAM,EAAE,KAAKP,KAAL,CAAWQ,WAAX,CAAuBV,GAAvB,CANZ;AAOI,MAAA,aAAa,EAAE,CACX,oBAAC,eAAD;AACI,QAAA,QAAQ,EAAEe,QADd;AAEI,QAAA,WAAW,EAAE,KAAKb,KAAL,CAAWW,WAAX,CAAuBU,GAAvB,CAA2BvB,GAA3B,CAFjB;AAGI,QAAA,OAAO,EAAE,MAAM;AACX,eAAKO,QAAL,CAAc;AAAEE,YAAAA,aAAa,EAAE;AAAjB,WAAd,EAAwC,MAAM;AAC1C,iBAAKgC,eAAL,CAAqBzC,GAArB,EAA0B,KAA1B;AACA,iBAAKI,gBAAL,CAAsBW,QAAtB,EAAgCf,GAAhC;AACH,WAHD;AAIH;AARL,SAWS2C,MAAD,IACI,oBAAC,YAAD;AACI,QAAA,EAAE,EAAE,UAAU3C,GADlB;AAEI,QAAA,GAAG,EAAC,MAFR;AAGI,QAAA,SAAS,EAAC,QAHd;AAII,QAAA,UAAU,EAAE,KAAK4C,SAAL,CAAe5C,GAAf,IAAsB,CAJtC;AAKI,QAAA,OAAO,EAAE2C;AALb,SAOI,oBAAC,WAAD,OAPJ,OAOoB,oBAAC,GAAD;AAAK,QAAA,MAAM,EAAC;AAAZ,QAPpB,CAZZ,CADW,EAwBX,oBAAC,mBAAD;AACI,QAAA,MAAM,EAAGA,MAAD,IACJ,oBAAC,YAAD;AACI,UAAA,EAAE,EAAE,YAAY3C,GADpB;AAEI,UAAA,GAAG,EAAC,QAFR;AAGI,UAAA,SAAS,EAAC,QAHd;AAII,UAAA,UAAU,EAAE,KAAK4C,SAAL,CAAe5C,GAAf,IAAsB,CAJtC;AAKI,UAAA,OAAO,EAAE2C;AALb,WAOI,oBAAC,WAAD,OAPJ,OAOoB,oBAAC,GAAD;AAAK,UAAA,MAAM,EAAC;AAAZ,UAPpB,CAFR;AAYI,QAAA,UAAU,EAAC,SAZf;AAaI,QAAA,YAAY,EAAC,mBAbjB;AAcI,QAAA,OAAO,EAAE,MACL,KAAKpC,QAAL,CAAc;AAAEE,UAAAA,aAAa,EAAE;AAAjB,SAAd,EAAwC,MAAM;AAC1C,eAAKgC,eAAL,CAAqBzC,GAArB,EAA0B,KAA1B;AACH,SAFD,CAfR;AAmBI,QAAA,UAAU,EAAE,MAAM,KAAKsB,WAAL,CAAiBP,QAAjB,EAA2Bf,GAA3B,EAAgCkB,IAAhC,CAAqC,MAAM,KAAKd,gBAAL,CAAsBW,QAAtB,EAAgCf,GAAhC,CAA3C;AAnBtB,QAxBW;AAPnB,MApBJ,CArGJ,CADJ,EAmLI,oBAAC,eAAD;AACI,MAAA,SAAS,EAAE,KADf;AAEI,oBAAW,iBAFf;AAGI,MAAA,EAAE,EAAE,cAAcA,GAHtB;AAII,MAAA,QAAQ,EAAE,CAAC,KAAKE,KAAL,CAAWC,SAAX,CAAqBH,GAArB;AAJf,OAMI,oBAAC,KAAD;AAAO,MAAA,MAAM,EAAC;AAAd,OACI,oBAAC,SAAD,QAAW,iCAAX,CADJ,EAEI,oBAAC,SAAD;AAAW,MAAA,EAAE,EAAE,8BAA8BA;AAA7C,OAAmD,KAAK0C,sBAAL,CAA4B1C,GAA5B,CAAnD,CAFJ,EAGI,oBAAC,SAAD,QAAW,iCAAX,CAHJ,CANJ,CAnLJ,CADH,CA1BL,CADJ;AA+NH;;AAzRsF;;gBAA9EJ,c,iBACYT,qB","sourcesContent":["/*\r\n * Copyright 2018 Red Hat, Inc. and/or its affiliates.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *      http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport * as React from 'react';\r\n\r\nimport {\r\n    DataList,\r\n    DataListItem,\r\n    DataListItemRow,\r\n    DataListCell,\r\n    DataListToggle,\r\n    DataListContent,\r\n    DataListItemCells,\r\n    Level,\r\n    LevelItem,\r\n    Button,\r\n    DataListAction,\r\n    DataListActionVisibility,\r\n    Dropdown,\r\n    DropdownPosition,\r\n    DropdownItem,\r\n    KebabToggle\r\n} from '@patternfly/react-core';\r\nimport { css } from '@patternfly/react-styles';\r\n\r\nimport { Remove2Icon, RepositoryIcon, ShareAltIcon, EditAltIcon } from '@patternfly/react-icons';\r\n\r\nimport { HttpResponse } from '../../account-service/account.service';\r\nimport { AccountServiceContext } from '../../account-service/AccountServiceContext';\r\nimport { PermissionRequest } from \"./PermissionRequest\";\r\nimport { ShareTheResource } from \"./ShareTheResource\";\r\nimport { Permission, Resource } from \"./resource-model\";\r\nimport { Msg } from '../../widgets/Msg';\r\nimport { ResourcesTableState, ResourcesTableProps, AbstractResourcesTable } from './AbstractResourceTable';\r\nimport { EditTheResource } from './EditTheResource';\r\nimport { ContentAlert } from '../ContentAlert';\r\nimport EmptyMessageState from '../../widgets/EmptyMessageState';\r\nimport { ContinueCancelModal } from '../../widgets/ContinueCancelModal';\r\n\r\nexport interface CollapsibleResourcesTableState extends ResourcesTableState {\r\n    isRowOpen: boolean[];\r\n    contextOpen: boolean[];\r\n    isModalActive: boolean;\r\n}\r\n\r\nexport class ResourcesTable extends AbstractResourcesTable<CollapsibleResourcesTableState> {\r\n    static contextType = AccountServiceContext;\r\n    context: React.ContextType<typeof AccountServiceContext>;\r\n\r\n    public constructor(props: ResourcesTableProps, context: React.ContextType<typeof AccountServiceContext>) {\r\n        super(props);\r\n        this.context = context;\r\n\r\n        this.state = {\r\n            isRowOpen: [],\r\n            contextOpen: [],\r\n            isModalActive: false,\r\n            permissions: new Map()\r\n        }\r\n    }\r\n\r\n    private onToggle = (row: number): void => {\r\n        const newIsRowOpen: boolean[] = this.state.isRowOpen;\r\n        newIsRowOpen[row] = !newIsRowOpen[row];\r\n        if (newIsRowOpen[row]) this.fetchPermissions(this.props.resources.data[row], row);\r\n        this.setState({ isRowOpen: newIsRowOpen });\r\n    };\r\n\r\n    private onContextToggle = (row: number, isOpen: boolean): void => {\r\n        if (this.state.isModalActive) return;\r\n        const data = this.props.resources.data;\r\n        const contextOpen = this.state.contextOpen;\r\n        contextOpen[row] = isOpen;\r\n        if (isOpen) {\r\n            const index = row > data.length ? row - data.length - 1 : row;\r\n            this.fetchPermissions(data[index], index);\r\n        }\r\n        this.setState({ contextOpen });\r\n    }\r\n\r\n    private fetchPermissions(resource: Resource, row: number): void {\r\n        this.context!.doGet(`/resources/${resource._id}/permissions`)\r\n            .then((response: HttpResponse<Permission[]>) => {\r\n                const newPermissions: Map<number, Permission[]> = new Map(this.state.permissions);\r\n                newPermissions.set(row, response.data || []);\r\n                this.setState({ permissions: newPermissions });\r\n            });\r\n    }\r\n\r\n    private removeShare(resource: Resource, row: number): Promise<void> {\r\n        const permissions = this.state.permissions.get(row)!.map(a => ({ username: a.username, scopes: [] }));\r\n        return this.context!.doPut(`/resources/${resource._id}/permissions`, permissions)\r\n            .then(() => {\r\n                ContentAlert.success(Msg.localize('unShareSuccess'));\r\n            });\r\n    }\r\n\r\n    public render(): React.ReactNode {\r\n        if (this.props.resources.data.length === 0) {\r\n            return (\r\n                <EmptyMessageState icon={RepositoryIcon} messageKey=\"notHaveAnyResource\"/>\r\n            );\r\n        }\r\n        return (\r\n            <DataList aria-label={Msg.localize('resources')} id=\"resourcesList\">\r\n                <DataListItem key='resource-header' aria-labelledby='resource-header'>\r\n                    <DataListItemRow>\r\n                        // invisible toggle allows headings to line up properly\r\n                        <span style={{ visibility: 'hidden' }}>\r\n                            <DataListToggle\r\n                                isExpanded={false}\r\n                                id='resource-header-invisible-toggle'\r\n                                aria-controls=\"ex-expand1\"\r\n                            />\r\n                        </span>\r\n                        <DataListItemCells\r\n                            dataListCells={[\r\n                                <DataListCell key='resource-name-header' width={5}>\r\n                                    <strong><Msg msgKey='resourceName' /></strong>\r\n                                </DataListCell>,\r\n                                <DataListCell key='application-name-header' width={5}>\r\n                                    <strong><Msg msgKey='application' /></strong>\r\n                                </DataListCell>,\r\n                                <DataListCell key='permission-request-header' width={5}>\r\n                                    <strong><Msg msgKey='permissionRequests' /></strong>\r\n                                </DataListCell>,\r\n                            ]}\r\n                        />\r\n                    </DataListItemRow>\r\n                </DataListItem>\r\n                {this.props.resources.data.map((resource: Resource, row: number) => (\r\n                    <DataListItem key={'resource-' + row} aria-labelledby={resource.name} isExpanded={this.state.isRowOpen[row]}>\r\n                        <DataListItemRow>\r\n                            <DataListToggle\r\n                                onClick={() => this.onToggle(row)}\r\n                                isExpanded={this.state.isRowOpen[row]}\r\n                                id={'resourceToggle-' + row}\r\n                                aria-controls=\"ex-expand1\"\r\n                            />\r\n                            <DataListItemCells\r\n                                dataListCells={[\r\n                                    <DataListCell id={'resourceName-' + row} key={'resourceName-' + row} width={5}>\r\n                                        <Msg msgKey={resource.name} />\r\n                                    </DataListCell>,\r\n                                    <DataListCell id={'resourceClient-' + row} key={'resourceClient-' + row} width={5}>\r\n                                        <a href={resource.client.baseUrl}>{this.getClientName(resource.client)}</a>\r\n                                    </DataListCell>,\r\n                                    <DataListCell id={'resourceRequests-' + row} key={'permissionRequests-' + row} width={5}>\r\n                                        {resource.shareRequests.length > 0 &&\r\n                                            <PermissionRequest\r\n                                                resource={resource}\r\n                                                onClose={() => this.fetchPermissions(resource, row)}\r\n                                            ></PermissionRequest>\r\n                                        }\r\n                                    </DataListCell>\r\n                                ]}\r\n                            />\r\n                            <DataListAction\r\n                                className={DataListActionVisibility.hiddenOnLg}\r\n                                aria-labelledby=\"check-action-item3 check-action-action3\"\r\n                                id=\"check-action-action3\"\r\n                                aria-label=\"Actions\"\r\n                            >\r\n                                <Dropdown\r\n                                    isPlain\r\n                                    position={DropdownPosition.right}\r\n                                    onSelect={() => this.setState({ isModalActive: true })}\r\n                                    toggle={<KebabToggle onToggle={isOpen => this.onContextToggle(row + this.props.resources.data.length + 1, isOpen)} />}\r\n                                    isOpen={this.state.contextOpen[row + this.props.resources.data.length + 1]}\r\n                                    dropdownItems={[\r\n                                        <ShareTheResource\r\n                                            resource={resource}\r\n                                            permissions={this.state.permissions.get(row)!}\r\n                                            sharedWithUsersMsg={this.sharedWithUsersMessage(row)}\r\n                                            onClose={() => {\r\n                                                this.setState({ isModalActive: false }, () => {\r\n                                                    this.onContextToggle(row + this.props.resources.data.length + 1, false);\r\n                                                    this.fetchPermissions(resource, row + this.props.resources.data.length + 1);\r\n                                                });\r\n                                            }}\r\n                                        >\r\n                                            {\r\n                                                (toggle: () => void) => (\r\n                                                    <DropdownItem id={'mob-share-' + row} key=\"mob-share\" onClick={toggle}>\r\n                                                        <ShareAltIcon /> <Msg msgKey=\"share\"/>\r\n                                                    </DropdownItem>)\r\n                                            }\r\n                                        </ShareTheResource>,\r\n                                        <EditTheResource\r\n                                            resource={resource}\r\n                                            permissions={this.state.permissions.get(row)!}\r\n                                            onClose={() => {\r\n                                                this.setState({ isModalActive: false }, () => {\r\n                                                    this.onContextToggle(row + this.props.resources.data.length + 1, false);\r\n                                                    this.fetchPermissions(resource, row + this.props.resources.data.length + 1);\r\n                                                });\r\n                                            }}\r\n                                        >\r\n                                            {\r\n                                                (toggle: () => void) => (\r\n                                                    <DropdownItem\r\n                                                        id={'mob-edit-' + row} key=\"mob-edit\"\r\n                                                        isDisabled={this.numOthers(row) < 0}\r\n                                                        onClick={toggle}\r\n                                                    >\r\n                                                        <EditAltIcon /> <Msg msgKey=\"edit\"/>\r\n                                                    </DropdownItem>)\r\n                                            }\r\n                                        </EditTheResource>,\r\n                                        <ContinueCancelModal\r\n                                            render={(toggle: () => void) => (\r\n                                                <DropdownItem\r\n                                                    id={'mob-remove-' + row}\r\n                                                    key=\"mob-remove\"\r\n                                                    isDisabled={this.numOthers(row) < 0}\r\n                                                    onClick={toggle}\r\n                                                >\r\n                                                    <Remove2Icon /> <Msg msgKey=\"unShare\"/>\r\n                                                </DropdownItem>\r\n                                            )}\r\n                                            modalTitle=\"unShare\"\r\n                                            modalMessage=\"unShareAllConfirm\"\r\n                                            onClose={() =>\r\n                                                this.setState({ isModalActive: false }, () => {\r\n                                                    this.onContextToggle(row + this.props.resources.data.length + 1, false);\r\n                                                })\r\n                                            }\r\n                                            onContinue={() => this.removeShare(resource, row)\r\n                                                .then(() => this.fetchPermissions(resource, row + this.props.resources.data.length + 1))}\r\n                                        />\r\n                                    ]}\r\n                                />\r\n                            </DataListAction>\r\n                            <DataListAction\r\n                                id={`actions-${row}`}\r\n                                className={css(DataListActionVisibility.visibleOnLg, DataListActionVisibility.hidden)}\r\n                                aria-labelledby=\"Row actions\"\r\n                                aria-label=\"Actions\"\r\n                            >\r\n                                <ShareTheResource\r\n                                    resource={resource}\r\n                                    permissions={this.state.permissions.get(row)!}\r\n                                    sharedWithUsersMsg={this.sharedWithUsersMessage(row)}\r\n                                    onClose={() => this.fetchPermissions(resource, row)}\r\n                                >\r\n                                    {\r\n                                        (toggle: () => void) => (\r\n                                            <Button id={`share-${row}`} variant=\"link\" onClick={toggle}>\r\n                                                <ShareAltIcon /> <Msg msgKey=\"share\"/>\r\n                                            </Button>\r\n                                        )\r\n                                    }\r\n                                </ShareTheResource>\r\n                                <Dropdown\r\n                                    id={`action-menu-${row}`}\r\n                                    isPlain\r\n                                    position={DropdownPosition.right}\r\n                                    toggle={<KebabToggle onToggle={isOpen => this.onContextToggle(row, isOpen)} />}\r\n                                    onSelect={() => this.setState({ isModalActive: true })}\r\n                                    isOpen={this.state.contextOpen[row]}\r\n                                    dropdownItems={[\r\n                                        <EditTheResource\r\n                                            resource={resource}\r\n                                            permissions={this.state.permissions.get(row)!}\r\n                                            onClose={() => {\r\n                                                this.setState({ isModalActive: false }, () => {\r\n                                                    this.onContextToggle(row, false);\r\n                                                    this.fetchPermissions(resource, row);\r\n                                                });\r\n                                            }}\r\n                                        >\r\n                                            {\r\n                                                (toggle: () => void) => (\r\n                                                    <DropdownItem\r\n                                                        id={'edit-' + row}\r\n                                                        key=\"edit\"\r\n                                                        component=\"button\"\r\n                                                        isDisabled={this.numOthers(row) < 0}\r\n                                                        onClick={toggle}\r\n                                                    >\r\n                                                        <EditAltIcon /> <Msg msgKey=\"edit\"/>\r\n                                                    </DropdownItem>)\r\n                                            }\r\n                                        </EditTheResource>,\r\n                                        <ContinueCancelModal\r\n                                            render={(toggle: () => void) => (\r\n                                                <DropdownItem\r\n                                                    id={'remove-' + row}\r\n                                                    key=\"remove\"\r\n                                                    component=\"button\"\r\n                                                    isDisabled={this.numOthers(row) < 0}\r\n                                                    onClick={toggle}\r\n                                                >\r\n                                                    <Remove2Icon /> <Msg msgKey=\"unShare\"/>\r\n                                                </DropdownItem>\r\n                                            )}\r\n                                            modalTitle=\"unShare\"\r\n                                            modalMessage='unShareAllConfirm'\r\n                                            onClose={() =>\r\n                                                this.setState({ isModalActive: false }, () => {\r\n                                                    this.onContextToggle(row, false);\r\n                                                })\r\n                                            }\r\n                                            onContinue={() => this.removeShare(resource, row).then(() => this.fetchPermissions(resource, row))}\r\n                                        />\r\n                                    ]}\r\n                                />\r\n                            </DataListAction>\r\n\r\n                        </DataListItemRow>\r\n                        <DataListContent\r\n                            noPadding={false}\r\n                            aria-label=\"Session Details\"\r\n                            id={'ex-expand' + row}\r\n                            isHidden={!this.state.isRowOpen[row]}\r\n                        >\r\n                            <Level gutter='md'>\r\n                                <LevelItem><span /></LevelItem>\r\n                                <LevelItem id={'shared-with-user-message-' + row}>{this.sharedWithUsersMessage(row)}</LevelItem>\r\n                                <LevelItem><span /></LevelItem>\r\n                            </Level>\r\n                        </DataListContent>\r\n                    </DataListItem>\r\n                ))}\r\n            </DataList>\r\n        );\r\n    }\r\n}"],"file":"ResourcesTable.js"}